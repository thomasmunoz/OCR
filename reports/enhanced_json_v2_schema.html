<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDP Pipeline - Enhanced JSON Schema v2.0</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background: #0f0f1a;
            color: #e0e0e0;
            line-height: 1.6;
        }
        .hero {
            background: linear-gradient(135deg, #7c3aed, #ec4899);
            color: white;
            padding: 40px;
            border-radius: 16px;
            margin-bottom: 30px;
            text-align: center;
        }
        .hero h1 { font-size: 2.5rem; margin: 0 0 10px 0; }
        .hero p { font-size: 1.2rem; opacity: 0.9; margin: 0; }
        .version-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 15px;
        }
        .card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        h2 {
            color: #7c3aed;
            border-bottom: 2px solid #7c3aed;
            padding-bottom: 8px;
            margin-top: 0;
        }
        h3 { color: #ec4899; margin-top: 20px; }
        .success { color: #10b981; }
        .warning { color: #f59e0b; }
        .error { color: #ef4444; }
        .code {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Menlo', 'Monaco', monospace;
            overflow-x: auto;
            margin: 10px 0;
            font-size: 0.85rem;
            white-space: pre-wrap;
            border: 1px solid rgba(124, 58, 237, 0.3);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        th {
            color: #7c3aed;
            background: rgba(124, 58, 237, 0.1);
        }
        tr:hover { background: rgba(124, 58, 237, 0.05); }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), rgba(236, 72, 153, 0.1));
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 12px;
            padding: 20px;
        }
        .feature-card h4 {
            color: #ec4899;
            margin: 0 0 10px 0;
            font-size: 1.1rem;
        }
        .feature-card p { margin: 0; opacity: 0.9; }
        .stat-box {
            display: inline-block;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            padding: 8px 16px;
            border-radius: 8px;
            margin: 5px;
        }
        .json-key { color: #7c3aed; }
        .json-string { color: #10b981; }
        .json-number { color: #f59e0b; }
        .json-bool { color: #ec4899; }
        .toc {
            background: rgba(124, 58, 237, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .toc h3 { margin-top: 0; }
        .toc ul { list-style: none; padding: 0; margin: 0; }
        .toc li { padding: 8px 0; }
        .toc a { color: #7c3aed; text-decoration: none; }
        .toc a:hover { text-decoration: underline; }
        .example-output {
            max-height: 500px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="hero">
        <h1>Enhanced JSON Schema v2.0</h1>
        <p>Comprehensive Document Analysis Output Format</p>
        <div class="version-badge">IDP Pipeline - December 2025</div>
    </div>

    <div class="toc">
        <h3>Table of Contents</h3>
        <ul>
            <li><a href="#features">Key Features</a></li>
            <li><a href="#structure">Schema Structure</a></li>
            <li><a href="#document">Document Information</a></li>
            <li><a href="#processing">Processing Information</a></li>
            <li><a href="#signatures">Signature Detection</a></li>
            <li><a href="#pages">Per-Page Statistics</a></li>
            <li><a href="#language">Language Detection</a></li>
            <li><a href="#example">Complete Example</a></li>
        </ul>
    </div>

    <section id="features" class="card">
        <h2>Key Features</h2>
        <div class="feature-grid">
            <div class="feature-card">
                <h4>Per-Page OCR Confidence</h4>
                <p>Every page includes extraction_confidence (0-1) indicating recognition quality.</p>
            </div>
            <div class="feature-card">
                <h4>Language Detection</h4>
                <p>Per-page language detection with confidence scores and script identification.</p>
            </div>
            <div class="feature-card">
                <h4>Word &amp; Character Counts</h4>
                <p>Detailed statistics per page including word_count, char_count, line_count.</p>
            </div>
            <div class="feature-card">
                <h4>Signature Detection</h4>
                <p>Identifies digital (PKI) signatures and handwritten signatures with locations.</p>
            </div>
            <div class="feature-card">
                <h4>Source Format Info</h4>
                <p>Tracks whether text came from digital layer, OCR, or hybrid extraction.</p>
            </div>
            <div class="feature-card">
                <h4>OCR Model Tracking</h4>
                <p>Records which AI model was used for extraction with repository info.</p>
            </div>
        </div>
    </section>

    <section id="structure" class="card">
        <h2>Top-Level Schema Structure</h2>
        <table>
            <tr><th>Field</th><th>Type</th><th>Description</th></tr>
            <tr><td class="json-key">schema_version</td><td>string</td><td>"2.0" - Schema version identifier</td></tr>
            <tr><td class="json-key">job_id</td><td>string</td><td>Unique processing job identifier (UUID)</td></tr>
            <tr><td class="json-key">processing_timestamp</td><td>string</td><td>ISO 8601 timestamp of processing</td></tr>
            <tr><td class="json-key">document</td><td>object</td><td>Document metadata (filename, hash, size)</td></tr>
            <tr><td class="json-key">processing</td><td>object</td><td>Processing details (models, timing)</td></tr>
            <tr><td class="json-key">total_pages</td><td>integer</td><td>Total number of pages</td></tr>
            <tr><td class="json-key">total_characters</td><td>integer</td><td>Total character count across all pages</td></tr>
            <tr><td class="json-key">total_words</td><td>integer</td><td>Total word count across all pages</td></tr>
            <tr><td class="json-key">primary_language</td><td>string</td><td>Dominant language code (ISO 639-1)</td></tr>
            <tr><td class="json-key">languages_detected</td><td>array</td><td>List of all languages found</td></tr>
            <tr><td class="json-key">signatures</td><td>object</td><td>Signature detection results</td></tr>
            <tr><td class="json-key">pages</td><td>array</td><td>Per-page detailed content and metadata</td></tr>
            <tr><td class="json-key">document_type</td><td>string</td><td>AI-detected document type (contract, invoice, etc.)</td></tr>
            <tr><td class="json-key">entities</td><td>object</td><td>AI-extracted entities (dates, names, amounts)</td></tr>
            <tr><td class="json-key">overall_confidence</td><td>number</td><td>Average extraction confidence (0-1)</td></tr>
        </table>
    </section>

    <section id="document" class="card">
        <h2>Document Information</h2>
        <div class="code">{
  "<span class="json-key">document</span>": {
    "<span class="json-key">original_filename</span>": <span class="json-string">"contract.pdf"</span>,
    "<span class="json-key">stored_filename</span>": <span class="json-string">"8f056c46.pdf"</span>,
    "<span class="json-key">file_format</span>": <span class="json-string">"pdf"</span>,
    "<span class="json-key">file_size_bytes</span>": <span class="json-number">936328</span>,
    "<span class="json-key">file_hash_sha256</span>": <span class="json-string">"d0bebb8b3201e689..."</span>,
    "<span class="json-key">mime_type</span>": <span class="json-string">"application/pdf"</span>
  }
}</div>
    </section>

    <section id="processing" class="card">
        <h2>Processing Information</h2>
        <p>Tracks exactly which AI models were used and how long each stage took.</p>
        <div class="code">{
  "<span class="json-key">processing</span>": {
    "<span class="json-key">pipeline_version</span>": <span class="json-string">"2.0"</span>,
    "<span class="json-key">ocr_model_name</span>": <span class="json-string">"Digital PDF Extraction (PyMuPDF)"</span>,
    "<span class="json-key">ocr_model_repository</span>": <span class="json-string">"N/A - Direct text extraction"</span>,
    "<span class="json-key">ocr_pages_processed</span>": <span class="json-number">10</span>,
    "<span class="json-key">extraction_seconds</span>": <span class="json-number">0.019</span>,
    "<span class="json-key">strategy</span>": <span class="json-string">"digital_pdf"</span>,
    "<span class="json-key">organization_model_name</span>": <span class="json-string">"TinyLlama-1.1B-Chat"</span>,
    "<span class="json-key">organization_model_repository</span>": <span class="json-string">"TinyLlama/TinyLlama-1.1B-Chat-v1.0"</span>,
    "<span class="json-key">organization_seconds</span>": <span class="json-number">29.22</span>,
    "<span class="json-key">total_seconds</span>": <span class="json-number">29.24</span>
  }
}</div>
        <h3>OCR Model Values</h3>
        <table>
            <tr><th>Model Name</th><th>Use Case</th></tr>
            <tr><td>Digital PDF Extraction (PyMuPDF)</td><td>Native digital text (fastest, 99% confidence)</td></tr>
            <tr><td>TrOCR-Large-Printed</td><td>Scanned documents with printed text</td></tr>
            <tr><td>TrOCR-Large-Handwritten</td><td>Handwritten documents</td></tr>
            <tr><td>Qwen2-VL-2B</td><td>Complex layouts, mixed content</td></tr>
            <tr><td>GOT-OCR2</td><td>High-accuracy OCR (state-of-the-art)</td></tr>
        </table>
    </section>

    <section id="signatures" class="card">
        <h2>Signature Detection</h2>
        <p>Detects both digital (PKI-based) signatures and handwritten signatures.</p>
        <div class="code">{
  "<span class="json-key">signatures</span>": {
    "<span class="json-key">status</span>": <span class="json-string">"both"</span>,
    "<span class="json-key">has_digital_signature</span>": <span class="json-bool">true</span>,
    "<span class="json-key">has_handwritten_signature</span>": <span class="json-bool">true</span>,
    "<span class="json-key">total_signature_count</span>": <span class="json-number">7</span>,
    "<span class="json-key">digital_signatures</span>": [
      {
        "<span class="json-key">page</span>": <span class="json-number">10</span>,
        "<span class="json-key">field_name</span>": <span class="json-string">"683f8015-5ea6-ed11-b18e..."</span>,
        "<span class="json-key">rect</span>": { "<span class="json-key">x</span>": <span class="json-number">243.5</span>, "<span class="json-key">y</span>": <span class="json-number">667.0</span>, "<span class="json-key">width</span>": <span class="json-number">125</span>, "<span class="json-key">height</span>": <span class="json-number">125</span> },
        "<span class="json-key">is_signed</span>": <span class="json-bool">true</span>
      }
    ],
    "<span class="json-key">handwritten_signatures</span>": [
      {
        "<span class="json-key">page</span>": <span class="json-number">8</span>,
        "<span class="json-key">location</span>": { "<span class="json-key">x</span>": <span class="json-number">172.26</span>, "<span class="json-key">y</span>": <span class="json-number">199.3</span>, "<span class="json-key">width</span>": <span class="json-number">150</span>, "<span class="json-key">height</span>": <span class="json-number">60</span> },
        "<span class="json-key">detection_confidence</span>": <span class="json-number">0.7</span>,
        "<span class="json-key">associated_text</span>": <span class="json-string">"signature"</span>,
        "<span class="json-key">detection_method</span>": <span class="json-string">"text_pattern_with_drawing"</span>
      }
    ]
  }
}</div>
        <h3>Signature Status Values</h3>
        <table>
            <tr><th>Status</th><th>Description</th></tr>
            <tr><td class="success">digitally_signed</td><td>Document has PKI digital signature(s)</td></tr>
            <tr><td class="success">manually_signed</td><td>Document has handwritten signature(s) detected</td></tr>
            <tr><td class="success">both</td><td>Document has both digital and handwritten signatures</td></tr>
            <tr><td class="warning">unsigned</td><td>No signatures detected</td></tr>
        </table>
    </section>

    <section id="pages" class="card">
        <h2>Per-Page Statistics</h2>
        <p>Each page in the <code>pages</code> array contains comprehensive metadata.</p>
        <div class="code">{
  "<span class="json-key">pages</span>": [
    {
      "<span class="json-key">page_number</span>": <span class="json-number">1</span>,
      "<span class="json-key">width</span>": <span class="json-number">612.0</span>,
      "<span class="json-key">height</span>": <span class="json-number">792.0</span>,

      "<span class="json-key">source</span>": {
        "<span class="json-key">source_type</span>": <span class="json-string">"digital_text"</span>,
        "<span class="json-key">extraction_method</span>": <span class="json-string">"direct"</span>,
        "<span class="json-key">ocr_model_used</span>": <span class="json-string">"Digital PDF Extraction"</span>,
        "<span class="json-key">has_text_layer</span>": <span class="json-bool">true</span>
      },

      "<span class="json-key">language</span>": {
        "<span class="json-key">detected</span>": <span class="json-string">"en"</span>,
        "<span class="json-key">confidence</span>": <span class="json-number">0.9999</span>,
        "<span class="json-key">alternate_languages</span>": [],
        "<span class="json-key">script</span>": <span class="json-string">"Latin"</span>
      },

      "<span class="json-key">statistics</span>": {
        "<span class="json-key">char_count</span>": <span class="json-number">1464</span>,
        "<span class="json-key">word_count</span>": <span class="json-number">206</span>,
        "<span class="json-key">line_count</span>": <span class="json-number">42</span>,
        "<span class="json-key">paragraph_count</span>": <span class="json-number">8</span>,
        "<span class="json-key">table_count</span>": <span class="json-number">0</span>,
        "<span class="json-key">image_count</span>": <span class="json-number">0</span>
      },

      "<span class="json-key">quality</span>": {
        "<span class="json-key">extraction_confidence</span>": <span class="json-number">0.99</span>,
        "<span class="json-key">ocr_confidence</span>": <span class="json-bool">null</span>,
        "<span class="json-key">text_clarity</span>": <span class="json-string">"excellent"</span>,
        "<span class="json-key">issues</span>": []
      },

      "<span class="json-key">raw_text</span>": <span class="json-string">"SERVICE AGREEMENT..."</span>
    }
  ]
}</div>
        <h3>Source Type Values</h3>
        <table>
            <tr><th>Source Type</th><th>Extraction Method</th><th>Typical Confidence</th></tr>
            <tr><td>digital_text</td><td>direct</td><td class="success">99%</td></tr>
            <tr><td>scanned_image</td><td>ocr</td><td class="warning">85-95%</td></tr>
            <tr><td>mixed_content</td><td>hybrid</td><td class="warning">75-95%</td></tr>
            <tr><td>image_with_text</td><td>ocr</td><td class="error">70-90%</td></tr>
        </table>
    </section>

    <section id="language" class="card">
        <h2>Language Detection</h2>
        <p>Each page includes detailed language detection with script identification.</p>
        <div class="code">{
  "<span class="json-key">language</span>": {
    "<span class="json-key">detected</span>": <span class="json-string">"en"</span>,
    "<span class="json-key">confidence</span>": <span class="json-number">0.9999</span>,
    "<span class="json-key">alternate_languages</span>": [
      { "<span class="json-key">lang</span>": <span class="json-string">"de"</span>, "<span class="json-key">confidence</span>": <span class="json-number">0.15</span> }
    ],
    "<span class="json-key">script</span>": <span class="json-string">"Latin"</span>
  }
}</div>
        <h3>Supported Scripts</h3>
        <table>
            <tr><th>Script</th><th>Languages</th></tr>
            <tr><td>Latin</td><td>English, French, German, Spanish, etc.</td></tr>
            <tr><td>Cyrillic</td><td>Russian, Ukrainian, Bulgarian</td></tr>
            <tr><td>Arabic</td><td>Arabic, Persian, Urdu</td></tr>
            <tr><td>CJK</td><td>Chinese, Japanese, Korean</td></tr>
            <tr><td>Mixed</td><td>Documents with multiple scripts</td></tr>
        </table>
    </section>

    <section id="example" class="card">
        <h2>Complete Example Output</h2>
        <p>Real output from processing a 10-page contract document:</p>
        <div class="example-output code">{
  "<span class="json-key">schema_version</span>": <span class="json-string">"2.0"</span>,
  "<span class="json-key">job_id</span>": <span class="json-string">"dabbd20b-d510-4b91-9ce4-2aa010e074dd"</span>,
  "<span class="json-key">processing_timestamp</span>": <span class="json-string">"2025-12-25T16:45:09.488335"</span>,

  "<span class="json-key">document</span>": {
    "<span class="json-key">original_filename</span>": <span class="json-string">"8f056c46.pdf"</span>,
    "<span class="json-key">file_format</span>": <span class="json-string">"pdf"</span>,
    "<span class="json-key">file_size_bytes</span>": <span class="json-number">936328</span>,
    "<span class="json-key">file_hash_sha256</span>": <span class="json-string">"d0bebb8b3201e6897986ed6c6812c21b..."</span>
  },

  "<span class="json-key">processing</span>": {
    "<span class="json-key">pipeline_version</span>": <span class="json-string">"2.0"</span>,
    "<span class="json-key">ocr_model_name</span>": <span class="json-string">"Digital PDF Extraction (PyMuPDF)"</span>,
    "<span class="json-key">organization_model_name</span>": <span class="json-string">"TinyLlama-1.1B-Chat"</span>,
    "<span class="json-key">total_seconds</span>": <span class="json-number">29.24</span>
  },

  "<span class="json-key">total_pages</span>": <span class="json-number">10</span>,
  "<span class="json-key">total_characters</span>": <span class="json-number">24087</span>,
  "<span class="json-key">total_words</span>": <span class="json-number">3552</span>,
  "<span class="json-key">primary_language</span>": <span class="json-string">"en"</span>,
  "<span class="json-key">languages_detected</span>": [<span class="json-string">"en"</span>],

  "<span class="json-key">signatures</span>": {
    "<span class="json-key">status</span>": <span class="json-string">"both"</span>,
    "<span class="json-key">has_digital_signature</span>": <span class="json-bool">true</span>,
    "<span class="json-key">has_handwritten_signature</span>": <span class="json-bool">true</span>,
    "<span class="json-key">total_signature_count</span>": <span class="json-number">7</span>
  },

  "<span class="json-key">document_type</span>": <span class="json-string">"contract"</span>,
  "<span class="json-key">overall_confidence</span>": <span class="json-number">0.99</span>,

  "<span class="json-key">pages</span>": [
    {
      "<span class="json-key">page_number</span>": <span class="json-number">1</span>,
      "<span class="json-key">language</span>": { "<span class="json-key">detected</span>": <span class="json-string">"en"</span>, "<span class="json-key">confidence</span>": <span class="json-number">0.99</span> },
      "<span class="json-key">statistics</span>": { "<span class="json-key">word_count</span>": <span class="json-number">206</span>, "<span class="json-key">char_count</span>": <span class="json-number">1464</span> },
      "<span class="json-key">quality</span>": { "<span class="json-key">extraction_confidence</span>": <span class="json-number">0.99</span> },
      "<span class="json-key">source</span>": { "<span class="json-key">source_type</span>": <span class="json-string">"digital_text"</span> }
    },
    <span class="json-string">// ... 9 more pages with same structure</span>
  ]
}</div>
    </section>

    <section class="card" style="background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(16,185,129,0.05)); border-color: rgba(16,185,129,0.3);">
        <h2 style="color: #10b981; border-color: #10b981;">Summary of User-Requested Features</h2>
        <table>
            <tr><th>Requested Feature</th><th>Location in JSON</th><th>Status</th></tr>
            <tr>
                <td>OCR confidence per page</td>
                <td><code>pages[].quality.extraction_confidence</code></td>
                <td class="success">Implemented</td>
            </tr>
            <tr>
                <td>Language per page</td>
                <td><code>pages[].language.detected</code></td>
                <td class="success">Implemented</td>
            </tr>
            <tr>
                <td>Word count per page</td>
                <td><code>pages[].statistics.word_count</code></td>
                <td class="success">Implemented</td>
            </tr>
            <tr>
                <td>Character count per page</td>
                <td><code>pages[].statistics.char_count</code></td>
                <td class="success">Implemented</td>
            </tr>
            <tr>
                <td>Which OCR AI was used</td>
                <td><code>processing.ocr_model_name</code></td>
                <td class="success">Implemented</td>
            </tr>
            <tr>
                <td>Page number tags</td>
                <td><code>pages[].page_number</code></td>
                <td class="success">Implemented</td>
            </tr>
            <tr>
                <td>Source format info</td>
                <td><code>pages[].source.source_type</code></td>
                <td class="success">Implemented</td>
            </tr>
            <tr>
                <td>Digital signature info</td>
                <td><code>signatures.digital_signatures[]</code></td>
                <td class="success">Implemented</td>
            </tr>
            <tr>
                <td>Handwritten signature info</td>
                <td><code>signatures.handwritten_signatures[]</code></td>
                <td class="success">Implemented</td>
            </tr>
            <tr>
                <td>Unsigned document detection</td>
                <td><code>signatures.status = "unsigned"</code></td>
                <td class="success">Implemented</td>
            </tr>
        </table>
    </section>

    <footer style="text-align: center; padding: 40px 0; color: rgba(255,255,255,0.5);">
        <p>IDP Pipeline Enhanced JSON Schema v2.0 - Generated December 25, 2025</p>
        <p>Oracle-Designed Document Processing System</p>
    </footer>
</body>
</html>
